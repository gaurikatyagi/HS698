<!DOCTYPE html>
<html lang="en">
	<head>
		<title>HeartAnalyzer - Blank page</title>

		<!-- BEGIN META -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="keywords" content="your,keywords">
		<meta name="description" content="Short explanation about this website">
		<!-- END META -->

		<!-- BEGIN STYLESHEETS -->
		<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,300,400,600,700,800' rel='stylesheet' type='text/css'/>
		<link rel=stylesheet type=text/css href="{{ url_for('static', filename='assets/css/theme-default/bootstrap.css') }}">
        <link rel=stylesheet type=text/css href="{{ url_for('static', filename='assets/css/theme-default/boostbox.css') }}">
        <link rel=stylesheet type=text/css href="{{ url_for('static', filename='assets/css/theme-default/font-awesome.min.css') }}">
        <link rel=stylesheet type=text/css href="{{ url_for('static', filename='assets/css/theme-default/boostbox_responsive.css') }}">
		<!-- END STYLESHEETS -->

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script type="text/javascript" src="{{ url_for('static', filename='assets/js/libs/utils/html5shiv.js') }}"></script>
		<script type="text/javascript" src="{{ url_for('static', filename='assets/js/libs/utils/respond.min.js') }}"></script>
		<![endif]-->

        <script data-require="d3@3.5.3" data-semver="3.5.3" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.js"></script>

        <style>

        body {
          font: 10px sans-serif;
        }

        .axis path,
        .axis line {
          fill: none;
          stroke: #000;
          shape-rendering: crispEdges;
        }

        .x.axis path {
          display: block;
        }

        .line {
          fill: none;
          stroke: blue;
          stroke-width: 1px;
        }

        </style>
	</head>
	<body >

			<!-- BEGIN HEADER-->
		<header id="header">

			<!-- BEGIN NAVBAR -->
			<nav class="navbar navbar-default" role="navigation">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
					<a class="btn btn-transparent btn-equal btn-menu" href="javascript:void(0);"><i class="fa fa-bars fa-lg"></i></a>
					<div class="navbar-brand">
						<a class="main-brand" href="{{ url_for('dashboard') }}">
							<h3 class="text-light text-white"><span>Heart<strong>Analyzer</strong> </span><i class="fa fa-heart"></i></h3>
						</a>
					</div><!--end .navbar-brand -->
					<a class="btn btn-transparent btn-equal navbar-toggle" data-toggle="collapse" data-target="#header-navbar-collapse"><i class="fa fa-wrench fa-lg"></i></a>
				</div>
				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse" id="header-navbar-collapse">
					<ul class="nav navbar-nav">
						<li><a href="{{ url_for('dashboard') }}"><i class="fa fa-home fa-lg"></i></a></li>
					</ul><!--end .nav -->
					<ul class="nav navbar-nav navbar-right">
						<li class="dropdown">
							<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-lg fa-flask"></i></a>
							<ul class="dropdown-menu animation-slide theme-selector">
								<li class="dropdown-header">Themes</li>
								<li><a href="theme-default">Theme default</a></li>
								<li><a href="theme-1">Theme 1</a></li>
								<li><a href="theme-2">Theme 2</a></li>
								<li><a href="theme-3">Theme 3</a></li>
								<li><a href="theme-4">Theme 4</a></li>
								<li><a href="theme-5">Theme 5</a></li>
							</ul><!--end .dropdown-menu -->
						</li><!--end .dropdown -->
                        <li><span class="navbar-devider"></span></li>
						<li class="dropdown">
							<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-lg fa-dashboard"></i>
                            <sup class="badge badge-support2">2</sup>
                            </a>
							<ul class="dropdown-menu animation-dock">
								<li class="dropdown-header">Server load</li>
								<li class="dropdown-progress">
									<a href="javascript:void(0);">
										<div class="dropdown-label">
											<span class="text-light">Server load <strong>Today</strong></span>
											<strong class="pull-right">93%</strong>
										</div>
										<div class="progress"><div class="progress-bar progress-bar-danger" style="width: 93%"></div></div>
									</a>
								</li><!--end .dropdown-progress -->
								<li class="dropdown-progress">
									<a href="javascript:void(0);">
										<div class="dropdown-label">
											<span class="text-light">Server load <strong>Yesterday</strong></span>
											<strong class="pull-right">30%</strong>
										</div>
										<div class="progress"><div class="progress-bar progress-bar-success" style="width: 30%"></div></div>
									</a>
								</li><!--end .dropdown-progress -->
								<li class="dropdown-progress">
									<a href="javascript:void(0);">
										<div class="dropdown-label">
											<span class="text-light">Server load <strong>Lastweek</strong></span>
											<strong class="pull-right">74%</strong>
										</div>
										<div class="progress"><div class="progress-bar progress-bar-warning" style="width: 74%"></div></div>
									</a>
								</li><!--end .dropdown-progress -->
							</ul><!--end .dropdown-menu -->
						</li><!--end .dropdown -->
						<li><span class="navbar-devider"></span></li>
						<li class="dropdown">
							<a href="javascript:void(0);" class="navbar-profile dropdown-toggle text-bold"
                               data-toggle="dropdown">Gaurika Tyagi <i class="fa fa-fw fa-angle-down"></i>
                                <img class="img-circle" src="{{ url_for('static', filename = 'assets/img/heart_beat.gif') }}" alt="" width="40" height="20"/>
                            </a>
							<ul class="dropdown-menu animation-slide">
								<li class="dropdown-header">Config</li>
								<li><a href="{{ url_for('profile') }}">My profile</a></li>
								<li class="divider"></li>
								<li><a href="{{ url_for('login') }}"><i class="fa fa-fw fa-power-off text-danger"></i> Logout</a></li>
							</ul><!--end .dropdown-menu -->
						</li><!--end .dropdown -->
					</ul><!--end .nav -->
				</div><!--end #header-navbar-collapse -->
			</nav>
			<!-- END NAVBAR -->

		</header>
		<!-- END HEADER-->

		<!-- BEGIN BASE-->
		<div id="base">

			<!-- BEGIN SIDEBAR-->
			<div id="sidebar">
				<div class="sidebar-back"></div>
				<div class="sidebar-content">
					<div class="nav-brand">
						<a class="main-brand" href="https://www.linkedin.com/in/gaurikatyagi">
							<h3 class="text-light text-white"><span>Heart<strong>Analyzer</strong> </span><i class="fa fa-heart"></i></h3>
						</a>
					</div>

					<!-- BEGIN MAIN MENU -->
					<ul class="main-menu">
						<!-- Menu Dashboard -->
						<li>
							<a href="{{ url_for('dashboard') }}" >
								<i class="fa fa-home fa-fw"></i><span class="title">Dashboard</span>
							</a>
						</li><!--end /menu-item -->
                        <li>
                            <a href="{{ url_for('profile') }}" >

                                <i class="fa fa-user fa-fw"></i><span class="title">User profile</span>
                            </a>
                        </li>
						<!-- Menu Pages -->
						<li>
							<a href="javascript:void(0);">
								<i class="fa fa-file fa-fw"></i><span class="title">I'll be right back</span> <span class="expand-sign">+</span>
							</a>
							<!--start submenu -->
							<ul>
								<li><a href="{{ url_for('locked') }}" ><i class="fa fa-key fa-fw"></i>Lock screen</a></li>
								<li><a href="{{ url_for('blank') }}" >Blank page</a></li>
							</ul><!--end /submenu -->
						</li><!--end /menu-item -->
                    </ul>
                </div><!-- Menu Tables -->
            </div><!--end #sidebar-->
            <!-- END SIDEBAR -->

			<!-- BEGIN CONTENT-->
			<div id="content">
				<!-- START BLANK SECTION -->
				<section>
					<ol class="breadcrumb">
						<li><a href="{{ url_for('dashboard') }}">home</a></li>
						<li class="active">Blank</li>
					</ol>
					<div class="section-header">
						<h3 class="text-standard"><i class="fa fa-fw fa-arrow-circle-right text-gray-light"></i>
                            Blank page</h3>
					</div>
					<div class="box-body">
                        <script src="//d3js.org/d3.v3.min.js"></script>

<script>

var margin = {top: 50, right: 0, bottom: 50, left: 330},
    width = 1200 - margin.left - margin.right,
    height = 600 - margin.top - margin.bottom;

var x = d3.time.scale()
    .range([0, width+90]);

var y = d3.scale.linear()
    .range([height-50, 0]);

var color = d3.scale.category10();

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");

var line = d3.svg.line()
    .interpolate("basis")
    .x(function(d) { return x(d.timer); })
    .y(function(d) { return y(d.beat_value); });

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + (margin.left) + "," + (margin.top) + ")");

d3.csv("{{ data_file }}", function(error, data) {
  if (error) throw error;

  color.domain(d3.keys(data[0]).filter(function(key) { return key !== "timer"; }));

  data.forEach(function(d) {
    d.timer = d.timer;
  });

  var cities = color.domain().map(function(name) {
    return {
      name: name,
      values: data.map(function(d) {
        return {timer: d.timer, beat_value: +d[name]};
      })
    };
  });

  x.domain(d3.extent(data, function(d) { return d.timer+10; }));

  y.domain([
    d3.min(cities, function(c) { return d3.min(c.values, function(v) { return v.beat_value; }); }),
    d3.max(cities, function(c) { return d3.max(c.values, function(v) { return v.beat_value; }); })
  ]);

  var legend = svg.selectAll('g')
      .data(cities)
      .enter()
      .append('g')
      .attr('class', 'legend');

    legend.append('rect')
      .attr('x', width - 90)
      .attr('y', function(d, i) {
        return i * 20;
      })
      .attr('width', 10)
      .attr('height', 10)
      .style('fill', function(d) {
        return color(d.name);
      });

    legend.append('text')
      .attr('x', width - 80)
      .attr('y', function(d, i) {
        return (i * 20) + 9;
      })
      .text(function(d) {
        return d.name;
      });

      svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 2)
      .attr("dy", "-3.91em")
      .style("text-anchor", "end")
      .text("Heart Beat Values");

  var beat_type = svg.selectAll(".beat_type")
      .data(cities)
    .enter().append("g")
      .attr("class", "beat_type");

  beat_type.append("path")
      .attr("class", "line")
      .attr("d", function(d) { return line(d.values); })
      .style("stroke", function(d) { return color(d.name); });

  beat_type.append("text")
      .datum(function(d) { return {name: d.name, value: d.values[d.values.length-1]}; })
      .attr("transform", function(d) { return "translate(" + x(d.value.timer) + "," + y(d.value.beat_value) + ")"; })
      .attr("x", 3)
      .attr("dy", "10.91em")
      .text(function(d) { return d.name; });


  var mouseG = svg.append("g")
      .attr("class", "mouse-over-effects");

    mouseG.append("path") // this is the black vertical line to follow mouse
      .attr("class", "mouse-line")
      .style("stroke", "black")
      .style("stroke-width", "1px")
      .style("opacity", "1");

  var lines = document.getElementsByClassName('line');

  var mousePerLine = mouseG.selectAll('.mouse-per-line')
      .data(cities)
      .enter()
      .append("g")
      .attr("class", "mouse-per-line");

    mousePerLine.append("circle")
      .attr("r", 7)
      .style("stroke", function(d) {
        return color(d.name);
      })
      .style("fill", "none")
      .style("stroke-width", "1px")
      .style("opacity", "1");

    mousePerLine.append("text")
      .attr("transform", "translate(10,3)");

    mouseG.append('svg:rect') // append a rect to catch mouse movements on canvas
      .attr('width', width) // can't catch mouse events on a g element
      .attr('height', height)
      .attr('fill', 'none')
      .attr('pointer-events', 'all')
      .on('mouseout', function() { // on mouse out hide line, circles and text
        d3.select(".mouse-line")
          .style("opacity", "0");
        d3.selectAll(".mouse-per-line circle")
          .style("opacity", "0");
        d3.selectAll(".mouse-per-line text")
          .style("opacity", "0");
      })
      .on('mouseover', function() { // on mouse in show line, circles and text
        d3.select(".mouse-line")
          .style("opacity", "1");
        d3.selectAll(".mouse-per-line circle")
          .style("opacity", "1");
        d3.selectAll(".mouse-per-line text")
          .style("opacity", "1");
      })
      .on('mousemove', function() { // mouse moving over canvas
        var mouse = d3.mouse(this);
        d3.select(".mouse-line")
          .attr("d", function() {
            var d = "M" + mouse[0] + "," + height;
            d += " " + mouse[0] + "," + 0;
            return d;
          });

        d3.selectAll(".mouse-per-line")
          .attr("transform", function(d, i) {
            console.log(width/mouse[0])
            var xtimer = x.invert(mouse[0]),
                bisect = d3.bisector(function(d) { return d.timer; }).right;
                idx = bisect(d.values, xtimer);

            var beginning = 0,
                end = lines[i].getTotalLength(),
                target = null;

            while (true){
              target = Math.floor((beginning + end) / 2);
              pos = lines[i].getPointAtLength(target);
              if ((target === end || target === beginning) && pos.x !== mouse[0]) {
                  break;
              }
              if (pos.x > mouse[0])      end = target;
              else if (pos.x < mouse[0]) beginning = target;
              else break; //position found
            }

            d3.select(this).select('text')
              .text(y.invert(pos.y).toFixed(2)); {# decimal points getting displayed #}

            return "translate(" + mouse[0] + "," + pos.y +")";
          });
      });
});


</script>
					</div><!--end .section-body -->
				</section>
				<!-- START BLANK SECTION -->
			</div><!--end #content-->
			<!-- END CONTENT -->

		</div><!--end #base-->
		<!-- END BASE -->

		<!-- BEGIN JAVASCRIPT -->
		<script src="{{ url_for('static', filename='assets/js/libs/jquery/jquery-1.11.0.min.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/libs/jquery/jquery-migrate-1.2.1.min.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/core/BootstrapFixed.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/libs/bootstrap/bootstrap.min.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/libs/spin.js/spin.min.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/libs/slimscroll/jquery.slimscroll.min.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/core/App.js')}}"></script>
		<script src="{{ url_for('static', filename='assets/js/core/demo/Demo.js')}}"></script>
		<!-- END JAVASCRIPT -->

	</body>
</html>